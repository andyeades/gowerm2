<?php
/**
 * Copyright Â© Magento, Inc. All rights reserved.
 * See COPYING.txt for license details.
 */

/** @var \Magento\Review\Block\Product\ReviewRenderer $block */

$url = $block->getReviewsUrl() . '#reviews';
$urlForm = $block->getReviewsUrl() . '#review-form';

?>
<?php if ($block->isReviewEnabled()) { ?>

    <?php
    $product = $block->getProductCurrent();
    $prod_id = $product->getId();

    $rating_label_value = 'percentage';
    $rating_value = ($product->getData('product_rating')*20)."%";


    // if check happybeds ?
    //$rating_label_number = $block->escapeHtmlAttr($rating);

    $rating_label_number = '';

    $rating_label_class = '';

    if ($rating_label_number == 'number') {
        if ($rating_label_number >= 4.7) {
            $rating_label_class = "prod-rating-5";
        } else if ($rating_label_number >= 4.4) {
            $rating_label_class = "prod-rating-4-4";
        } else if ($rating_label_number >= 4) {
            $rating_label_class = "prod-rating-4";
        } else if ($rating_label_number >= 3) {
            $rating_label_class = "prod-rating-3";
        } else if ($rating_label_number >= 2) {
            $rating_label_class = "prod-rating-2";
        } else if ($rating_label_number >= 1) {
            $rating_label_class = "prod-rating-1";
        }
    } else {
        // Percentage input
        switch($rating_value) {
            case '100%':
                $rating_style = '109px';
                break;
            case '98%':
                $rating_style = '106.82px';
                break;
            case '96%':
                $rating_style = '104.64px';
                break;
            case '94%':
                $rating_style = '102.46px';
                break;
            case '92%':
                $rating_style = '100.28px';
                break;
            case '90%':
                $rating_style = '98.1px';
                break;
            case '88%':
                $rating_style = '95.92px';
                break;
            case '86%':
                $rating_style = '93.74px';
                break;
            case '84%':
                $rating_style = '91.56px';
                break;
            case '82%':
                $rating_style = '89.38px';
                break;
            case "80%":
                $rating_style = '87.2px';
                break;
            case '78%':
                $rating_style = '85.02px';
                break;
            case '76%':
                $rating_style = '82.84px';
                break;
            case '74%':
                $rating_style = '80.66px';
                break;
            case '72%':
                $rating_style = '78.48px';
                break;
            case '70%':
                $rating_style = '76.3px';
                break;
            case '68%':
                $rating_style = '74.12px';
                break;
            case '66%':
                $rating_style = '71.94px';
                break;
            case '64%':
                $rating_style = '69.76px';
                break;
            case '62%':
                $rating_style = '67.58px';
                break;
            case '60%':
                $rating_style = '65.4px';
                break;
            case '58%':
                $rating_label_style = '58%;';
                $rating_style = '63.22px';
                break;
            case '56%':
                $rating_label_style = '56%;';
                $rating_style = '61.04px';
                break;
            case '54%':
                $rating_label_style = '54%;';
                $rating_style = '58.86px';
                break;
            case '52%':
                $rating_label_style = '52%;';
                $rating_style = '56.68px';
                break;
            case '50%':
                $rating_label_style = '50%;';
                $rating_style = '54.5px';
                break;
            case '48%':
                $rating_label_style = '48%;';
                $rating_style = '52.32px';
                break;
            case '46%':
                $rating_label_style = '46%;';
                $rating_style = '50.14px';
                break;
            case '44%':
                $rating_label_style = '44%;';
                $rating_style = '47.96px';
                break;
            case '41%':
                $rating_label_style = '42%;';
                $rating_style = '45.78px';
                break;
            case '40%':
                $rating_label_style = '40%;';
                $rating_style = '43.6px';
                break;
            case '38%':
                $rating_label_style = '38%;';
                $rating_style = '41.42px';
                break;
            case 1.8:
                $rating_label_style = '36%;';
                $rating_style = '39.24px';
                break;
            case 1.7:
                $rating_label_style = '34%;';
                $rating_style = '37.06px';
                break;
            case 1.6:
                $rating_label_style = '32%;';
                $rating_style = '34.88px';
                break;
            case '30%':
                $rating_label_style = '30%;';
                $rating_style = '32.77px';
                break;
            case 1.4:
                $rating_label_style = '28%;';
                $rating_style = '30.52px';
                break;
            case 1.3:
                $rating_label_style = '26%;';
                $rating_style = '28.34px';
                break;
            case 1.2:
                $rating_label_style = '24%;';
                $rating_style = '26.16px';
                break;
            case 1.1:
                $rating_label_style = '22%;';
                $rating_style = '23.98px';
                break;
            case '20%':
                $rating_label_style = '20%;';
                $rating_style = '21.8px';
                break;
            case 0.9:
                $rating_label_style = '18%;';
                $rating_style = '19.62px';
                break;
            case 0.8:
                $rating_label_style = '16%;';
                $rating_style = '17.44px';
                break;
            case 0.7:
                $rating_label_style = '14%;';
                $rating_style = '15.26px';
                break;
            case 0.6:
                $rating_label_style = '12%;';
                $rating_style = '13.08px';
                break;
            case '10%':
                $rating_label_style = '10%;';
                $rating_style = '10.9px';
                break;
            case 0.4:
                $rating_label_style = '8%;';
                $rating_style = '8.72px';
                break;
            case 0.3:
                $rating_label_style = '6%;';
                $rating_style = '6.54px';
                break;
            case 0.2:
                $rating_label_style = '4%;';
                $rating_style = '4.36px';
                break;
            case 0.1:
                $rating_label_style = '2%;';
                $rating_style = '2.18px';
                break;
            case 0:
                $rating_label_style = '0%;';
                $rating_style = '0';
                break;
            default:
                $rating_label_style = '0%;';
                $rating_style = '0';
        }

        if ($rating_label_number >= 4.7) {
            $rating_label_class = "prod-rating-5";
        } else if ($rating_label_number >= 4.4) {
            $rating_label_class = "prod-rating-4-4";
        } else if ($rating_label_number >= 4) {
            $rating_label_class = "prod-rating-4";
        } else if ($rating_label_number >= 3) {
            $rating_label_class = "prod-rating-3";
        } else if ($rating_label_number >= 2) {
            $rating_label_class = "prod-rating-2";
        } else if ($rating_label_number >= 1) {
            $rating_label_class = "prod-rating-1";
        }
    }



    ?>
    <style type="text/css">
        #product-review-summary-<?= $prod_id ?> .rating-result:before {
            width: <?= $rating_style ?>;
        }
    </style>
    <?php if($product->getData('rating_count') > 0){
        $review_text = '';

        if ($product->getData('rating_count') == 1) {
            $review_text = "Review";
        } else {
            $review_text = "Reviews";
        } ?>
        <div id="product-review-summary-<?= $prod_id ?>" class="product-reviews-summary short<?= !$rating_value ? ' no-rating' : '' ?>">
            <div class="rating-summary">
                <span class="label"><span><?= $block->escapeHtml(__('Rating')) ?>:</span></span>
                <div class="rating-result" title="<?= $block->escapeHtmlAttr($rating_value) ?>">
                    <span style="width:<?= $block->escapeHtmlAttr($rating_value) ?>"><span><?= $block->escapeHtml($rating_value) ?>%</span></span>
                </div>
            </div>
            <div class="reviews-actions">
                <a class="action view" href="<?= $block->escapeUrl($url) ?>"><?= $product->getData('rating_count'); ?>&nbsp;<span><?= $review_text; ?></span></a>
            </div>
        </div>

    <?php } ?>
<?php } ?>
