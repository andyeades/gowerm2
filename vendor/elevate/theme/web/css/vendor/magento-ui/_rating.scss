//
//  Ratings
//

//  Rating-vote mixin
@mixin lib-rating-vote(
    $-icon-count          : $rating-icon-count,
    $-icon-content        : $rating-icon-content,
    $-icon-font           : $rating-icon-font,
    $-icon-font-size      : $rating-icon-font-size,
    $-icon-letter-spacing : $rating-icon-letter-spacing,
    $-icon-color          : $rating-icon-color,
    $-icon-color-active   : $rating-icon-active-color
) {
    overflow: hidden;

    &:before {
        @include _lib-rating-icon-defalt(
            $-icon-font,
            $-icon-font-size,
            $-icon-letter-spacing,
            $-icon-color
        );
        @include lib-rating-icons-content(
            $-icon-count,
            $-icon-content
        );
        display: block;
        position: absolute;
        z-index: 1;
    }

    input[type="radio"] {
        @include lib-visually-hidden();

        &:focus,
        &:checked {
            + label {
                &:before {
                    opacity: 1;
                }
            }
        }
    }

    label {
        cursor: pointer;
        display: block;
        position: absolute;

        span {
            @include lib-visually-hidden();
        }

        &:before {
            @include _lib-rating-icon-defalt(
                $-icon-font,
                $-icon-font-size,
                $-icon-letter-spacing,
                $-icon-color-active
            );
            opacity: 0;
        }

        &:hover {
            &:before {
                opacity: 1;
            }

            ~ label {
                &:before {
                    opacity: 0;
                }
            }
        }
    }

    @include _lib-rating-iteration(
        $-icon-content,
        $-icon-count
    );
}

//  Rating-summary mixin
@mixin lib-rating-summary(
    $-icon-count          : $rating-icon-count,
    $-icon-content        : $rating-icon-content,
    $-icon-font           : $rating-icon-font,
    $-icon-font-size      : $rating-icon-font-size,
    $-icon-letter-spacing : $rating-icon-letter-spacing,
    $-icon-color          : $rating-icon-color,
    $-icon-color-active   : $rating-icon-active-color,
    $-label-hide          : $rating-label-hide
) {
    overflow: hidden;
    white-space: nowrap;
    @include _lib-rating-label-hide($-label-hide);

    .rating-result {
        @include lib-css(width, ($-icon-font-size * $-icon-count) + ceil($-icon-letter-spacing * ($-icon-count - 1)));
        display: inline-block;
        position: relative;
        vertical-align: middle;

        &:before {
            left: 0;
            position: absolute;
            top: 0;
            width: 100%;
            z-index: 1;
            @include _lib-rating-summary-icon-default(
                $-icon-font,
                $-icon-font-size,
                $-icon-letter-spacing,
                $-icon-count,
                $-icon-content,
                $-icon-color
            );
        }

        > span {
            display: block;
            overflow: hidden;

            &:before {
                position: relative;
                z-index: 2;
                @include _lib-rating-summary-icon-default(
                    $-icon-font,
                    $-icon-font-size,
                    $-icon-letter-spacing,
                    $-icon-count,
                    $-icon-content,
                    $-icon-color-active
                );
            }

            span {
                @include lib-visually-hidden();
            }
        }
    }
}

@mixin lib-rating-summary-label-hide() {
    .label {
        @include lib-visually-hidden();
    }
}

//  Internal use mixins
@mixin _lib-rating-label-hide($-label-hide) {
    @if $-label-hide == true {
        @include lib-rating-summary-label-hide();
    }
}

@mixin _lib-rating-iteration(
    $-icon-content,
    $-icon-count
) {
    @for $-index from $-icon-count to 0 {
        .rating-#{$-index} {
            z-index: $-icon-count - ($-index - 2);
            &:before {
                @include lib-rating-icons-content($-index, $-icon-content);
            }
        }
    }
}

@mixin _lib-rating-icon-defalt(
    $-icon-font,
    $-icon-font-size,
    $-icon-letter-spacing,
    $-icon-color
) {
    @include lib-css(color, $-icon-color);
    @include lib-css(font-family, $-icon-font);
    @include lib-css(font-size, $-icon-font-size);
    @include lib-css(height, $-icon-font-size);
    @include lib-css(letter-spacing, $-icon-letter-spacing);
    @include lib-css(line-height, $-icon-font-size);
    font-style: normal;
    font-weight: normal;
    speak: none;
    vertical-align: top;
    -webkit-font-smoothing: antialiased;
}

@mixin _lib-rating-summary-icon-default(
    $-icon-font,
    $-icon-font-size,
    $-icon-letter-spacing,
    $-icon-count,
    $-icon-content,
    $-icon-color
) {
    -webkit-font-smoothing: antialiased;
    @include lib-css(color, $-icon-color);
    @include lib-css(font-family, $-icon-font);
    @include lib-css(font-size, $-icon-font-size);
    @include lib-css(height, $-icon-font-size);
    @include lib-css(letter-spacing, $-icon-letter-spacing);
    @include lib-css(line-height, $-icon-font-size);
    @include lib-rating-icons-content($-icon-count, $-icon-content);
    display: block;
    font-style: normal;
    font-weight: normal;
    speak: none;
}

@mixin lib-rating-icons-content(
    $-icon-count: $rating-icon-count,
    $-icon-content: $rating-icon-content
) {
    $-icon-content-result: $-icon-content;

    @for $-index from $-icon-count to 1 {
        $-icon-content-result:  $-icon-content-result + $-icon-content;
    }

   @include co(content, $-icon-content-result);
}
