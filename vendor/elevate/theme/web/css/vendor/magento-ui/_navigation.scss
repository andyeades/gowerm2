//
//  Navigation
//

@mixin lib-main-navigation(
    $-nav-indent-side                        : 15px,
    $-nav-background-color                    : $navigation-background,
    $-nav-border                              : $navigation-border,
    $-nav-level0-font-size                    : $navigation-level0-item-font-size,
    $-nav-level0-font-weight                  : $navigation-level0-item-font-weight,
    $-nav-level0-item-line-height             : $navigation-level0-item-line-height,
    $-nav-level0-item-margin                  : $navigation-level0-item-margin,
    $-nav-level0-item-padding                 : $navigation-level0-item-padding,
    $-nav-level0-text-transform               : $navigation-level0-item-text-transform,

    $-nav-level0-item-background-color        : $navigation-level0-item-background,
    $-nav-level0-item-border                  : $navigation-level0-item-border,
    $-nav-level0-item-color                   : $navigation-level0-item-color,
    $-nav-level0-item-text-decoration         : $navigation-level0-item-text-decoration,

    $-nav-level0-item-background-color-active : $navigation-level0-item-active-background,
    $-nav-level0-item-active-border-color   : $navigation-level0-item-active-border-color,
    $-nav-level0-item-active-border-style   : $navigation-level0-item-active-border-style,
    $-nav-level0-item-active-border-width   : $navigation-level0-item-active-border-width,
    $-nav-level0-item-color-active            : $navigation-level0-item-active-color,
    $-nav-level0-item-text-decoration-active  : $navigation-level0-item-active-text-decoration,

    $-submenu-background-color                : $submenu-background,
    $-submenu-border                          : $submenu-border,
    $-submenu-font-size                       : $submenu-font-size,
    $-submenu-font-weight                     : $submenu-font-weight,
    $-submenu-line-height                     : $submenu-item-line-height,
    $-submenu-item-padding-top               : $submenu-padding-top,
    $-submenu-item-padding-right             : $submenu-padding-right,
    $-submenu-item-padding-bottom            : $submenu-padding-bottom,
    $-submenu-item-padding-left              : $submenu-padding-left,

    $-submenu-item-background-color           : $submenu-item-background,
    $-submenu-item-border                     : $submenu-item-border,
    $-submenu-item-color                      : $submenu-item-color,
    $-submenu-item-text-decoration            : $submenu-item-text-decoration,

    $-submenu-item-background-color-active    : $submenu-item-active-background,
    $-submenu-item-active-border            : $submenu-item-active-border,
    $-submenu-item-active-border-color      : $submenu-item-active-border-color,
    $-submenu-item-active-border-style      : $submenu-item-active-border-style,
    $-submenu-item-active-border-width      : $submenu-item-active-border-width,
    $-submenu-item-color-active               : $submenu-item-active-color,
    $-submenu-item-text-decoration-active     : $submenu-item-active-text-decoration
) {
    .navigation {
        @include lib-css(background, $-nav-background-color);
        @include lib-css(border, $-nav-border);


        ul {
            margin: 0;
            padding: 0;
        }

        li {
            margin: 0;
        }

        a {
            display: block;
            @include lib-css(padding, $-submenu-item-padding-top $-submenu-item-padding-right $-submenu-item-padding-bottom $-submenu-item-padding-left);
        }

        a,
        a:hover {
            @include lib-css(color, $-nav-level0-item-color);
            @include lib-css(text-decoration, $-nav-level0-item-text-decoration);
        }

        .level0 {
            @include lib-css(border-top, $-nav-level0-item-border);
            @include lib-font-size($-nav-level0-font-size);

            > .level-top {
                @include lib-css(background, $-nav-level0-item-background-color);
                @include lib-css(font-weight, $-nav-level0-font-weight);
                @include lib-css(line-height, $-nav-level0-item-line-height);
                @include lib-css(padding, $-nav-level0-item-padding);
                @include lib-css(text-transform, $-nav-level0-text-transform);
                word-wrap: break-word;
            }

            &.active {
                .all-category {
                    .ui-state-focus {
                        @include lib-css(background, $-nav-level0-item-background-color-active);
                        @include lib-css(border-color, $-nav-level0-item-active-border-color);
                        @include lib-css(border-style, $-nav-level0-item-active-border-style);
                        @include lib-css(border-width, $-nav-level0-item-active-border-width);
                        @include lib-css(color, $-nav-level0-item-color-active);
                        @include lib-css(padding-left, $-nav-indent-side - $-submenu-item-active-border);
                        @include lib-css(text-decoration, $-nav-level0-item-text-decoration-active);
                        display: inline-block;
                    }
                }
            }

            > .level1 {
                @include lib-css(font-weight, $font-weight-semibold);
            }

            &.active,
            &.has-active { // ToDo UI: remove "has_active" here, when mobile navigation default open state is implemented
                > a:not(.ui-state-active) {
                    @include lib-css(background, $-nav-level0-item-background-color-active);
                    @include lib-css(border-color, $-nav-level0-item-active-border-color);
                    @include lib-css(border-style, $-nav-level0-item-active-border-style);
                    @include lib-css(border-width, $-nav-level0-item-active-border-width);
                    @include lib-css(color, $-nav-level0-item-color-active);
                    @include lib-css(text-decoration, $-nav-level0-item-text-decoration-active);

                    span:not(.ui-menu-icon) {
                        @include lib-css(margin-left, -$-submenu-item-active-border);
                    }
                }
            }
        }

        li.level0 {
            &:last-child {
                @include lib-css(border-bottom, $-nav-level0-item-border);
            }
        }

        .submenu {
            > li {
                word-wrap: break-word;
            }

            &:not(:first-child) {
                @include lib-css(background, $-submenu-background-color);
                @include lib-css(border, $-submenu-border);
                @include lib-css(font-size, $-submenu-font-size);
                @include lib-css(font-weight, $-submenu-font-weight);
                @include lib-css(line-height, $-submenu-line-height);
                left: auto !important;
                overflow-x: hidden;
                padding: 0;
                position: relative;
                top: auto !important;
                transition: left 0.3s ease-out;

                > li {
                    > a {
                        @include lib-css(padding-left, $-nav-indent-side);
                    }

                    &:last-child {
                        margin-bottom: 0;
                    }
                }

                ul {
                    display: block;
                    @include lib-css(padding-left, $-submenu-item-padding-left);

                    > li {
                        margin: 0;

                        a {
                            @include lib-css(background, $-submenu-item-background-color);
                            @include lib-css(border, $-submenu-item-border);
                            @include lib-css(color, $-submenu-item-color);
                            @include lib-css(text-decoration, $-submenu-item-text-decoration);
                            display: block;
                            line-height: normal;
                        }
                    }
                }

                &.expanded {
                    display: block !important;
                    padding-right: 0;
                    top: 0 !important;
                }

                .active {
                    > a {
                        @include lib-css(background, $-submenu-item-background-color-active);
                        @include lib-css(border-color, $-submenu-item-active-border-color);
                        @include lib-css(border-style, $-submenu-item-active-border-style);
                        @include lib-css(border-width, $-submenu-item-active-border-width);
                        @include lib-css(color, $-submenu-item-color-active);
                        @include lib-css(padding-left, $-nav-indent-side - $-submenu-item-active-border);
                        @include lib-css(text-decoration, $-submenu-item-text-decoration-active);
                    }
                }

                .level1 {
                    &.active {
                        > a {
                            @include lib-css(padding-left, $-nav-indent-side - $-submenu-item-active-border);
                        }
                    }
                }
            }
        }
    }
}

//
//  Desktop
//

@mixin lib-main-navigation-desktop(
    $-nav-background-color                    : $navigation-desktop-background,
    $-nav-border                              : $navigation-desktop-border,
    $-nav-font-size                           : $navigation-desktop-font-size,
    $-nav-font-weight                         : $navigation-desktop-font-weight,

    $-nav-level0-item-line-height             : $navigation-desktop-level0-item-line-height,
    $-nav-level0-item-margin                  : $navigation-desktop-level0-item-margin,
    $-nav-level0-item-padding                 : $navigation-desktop-level0-item-padding,

    $-nav-level0-item-background-color        : $navigation-desktop-level0-item-background,
    $-nav-level0-item-border                  : $navigation-desktop-level0-item-border,
    $-nav-level0-item-color                   : $navigation-desktop-level0-item-color,
    $-nav-level0-item-text-decoration         : $navigation-desktop-level0-item-text-decoration,

    $-nav-level0-item-background-color-hover  : $navigation-desktop-level0-item-hover-background,
    $-nav-level0-item-border-hover            : $navigation-desktop-level0-item-hover-border,
    $-nav-level0-item-color-hover             : $navigation-desktop-level0-item-hover-color,
    $-nav-level0-item-text-decoration-hover   : $navigation-desktop-level0-item-hover-text-decoration,

    $-nav-level0-item-background-color-active : $navigation-desktop-level0-item-active-background,
    $-nav-level0-item-active-border-color   : $navigation-desktop-level0-item-active-border-color,
    $-nav-level0-item-active-border-style   : $navigation-desktop-level0-item-active-border-style,
    $-nav-level0-item-active-border-width   : $navigation-desktop-level0-item-active-border-width,
    $-nav-level0-item-color-active            : $navigation-desktop-level0-item-active-color,
    $-nav-level0-item-text-decoration-active  : $navigation-desktop-level0-item-active-text-decoration,

    $-submenu-background-color                : $submenu-desktop-background,
    $-submenu-border-width                    : $submenu-desktop-border-width,
    $-submenu-border-style                    : $submenu-desktop-border-style,
    $-submenu-border-color                    : $submenu-desktop-border-color,
    $-submenu-box-shadow                      : $submenu-desktop-box-shadow,
    $-submenu-font-size                       : $submenu-desktop-font-size,
    $-submenu-font-weight                     : $submenu-desktop-font-weight,
    $-submenu-min-width                       : $submenu-desktop-min-width,
    $-submenu-padding                         : $submenu-desktop-padding,

    $-submenu-arrow                           : $submenu-desktop-arrow,
    $-submenu-arrow-size                      : $submenu-desktop-arrow-size,
    $-submenu-arrow-left                      : $submenu-desktop-arrow-left,

    $-submenu-item-padding                    : $submenu-desktop-item-padding,
    $-submenu-item-background-color           : $submenu-desktop-item-background,
    $-submenu-item-border                     : $submenu-desktop-item-border,
    $-submenu-item-color                      : $submenu-desktop-item-color,
    $-submenu-item-text-decoration            : $submenu-desktop-item-text-decoration,

    $-submenu-item-hover-background-color   : $submenu-desktop-item-hover-background,
    $-submenu-item-border-hover               : $submenu-desktop-item-hover-border,
    $-submenu-item-color-hover                : $submenu-desktop-item-hover-color,
    $-submenu-item-text-decoration-hover      : $submenu-desktop-item-hover-text-decoration,

    $-submenu-item-background-color-active    : $submenu-desktop-item-active-background,
    $-submenu-item-active-border-color      : $submenu-desktop-item-active-border-color,
    $-submenu-item-active-border-style      : $submenu-desktop-item-active-border-style,
    $-submenu-item-active-border-width      : $submenu-desktop-item-active-border-width,
    $-submenu-item-color-active               : $submenu-desktop-item-active-color,
    $-submenu-item-text-decoration-active     : $submenu-desktop-item-active-text-decoration
) {

    .navigation {
        @include lib-css(background, $-nav-background-color);
        @include lib-css(border, $-nav-border);
        @include lib-css(font-size, $-nav-font-size);
        @include lib-css(font-weight, $-nav-font-weight);
        height: inherit;
        left: auto;
        overflow: inherit;
        padding: 0;
        position: relative;
        top: 0;
        width: 100%;
        z-index: 3;

        &:empty {
            display: none;
        }

        ul {
            margin-top: 0;
            margin-bottom: 0;
            padding: 0;
            position: relative;
        }

        li.level0 {
            @include lib-css(border-top, none);
        }

        .level0 {
            @include lib-css(margin, $-nav-level0-item-margin);
            display: inline-block;
            position: relative;

            &:last-child {
                margin-right: 0;
                padding-right: 0;
            }

            > .level-top {
                @include lib-css(background, $-nav-level0-item-background-color);
                @include lib-css(border, $-nav-level0-item-border);
                @include lib-css(color, $-nav-level0-item-color);
                @include lib-css(line-height, $-nav-level0-item-line-height);
                @include lib-css(padding, $-nav-level0-item-padding);
                @include lib-css(text-decoration, $-nav-level0-item-text-decoration);

                position: relative;

                &:hover,
                &.ui-state-focus {
                    @include lib-css(background, $-nav-level0-item-background-color-hover);
                    @include lib-css(border, $-nav-level0-item-border-hover);
                    @include lib-css(color, $-nav-level0-item-color-hover);
                    @include lib-css(text-decoration, $-nav-level0-item-text-decoration-hover);
                }
            }

            &.active,
            &.has-active {
                > .level-top {
                    @include lib-css(background, $-nav-level0-item-background-color-active);
                    @include lib-css(border-color, $-nav-level0-item-active-border-color);
                    @include lib-css(border-style, $-nav-level0-item-active-border-style);
                    @include lib-css(border-width, $-nav-level0-item-active-border-width);
                    @include lib-css(color, $-nav-level0-item-color-active);
                    @include lib-css(text-decoration, $-nav-level0-item-text-decoration-active);
                    display: inline-block;
                }
            }

            &.parent:hover > .submenu {
                overflow: visible !important;
            }

            .submenu {
                @include lib-css(background, $-submenu-background-color);
                @include lib-css(border, $-submenu-border-width $-submenu-border-style $-submenu-border-color);
                @include lib-css(box-shadow, $-submenu-box-shadow);
                @include lib-css(font-size, $-submenu-font-size);
                @include lib-css(font-weight, $-submenu-font-weight);
                @include lib-css(min-width, $-submenu-min-width);
                @include lib-css(padding, $-submenu-padding);
                display: none;
                left: 0;
                margin: 0 !important;
                padding: 0;
                position: absolute;
                z-index: 1;

                @include _lib-submenu-arrow(
                    $-submenu-arrow,
                    $-bg     : $-submenu-background-color,
                    $-border : $-submenu-border-color,
                    $-size   : $-submenu-arrow-size,
                    $-left   : $-submenu-arrow-left
                );

                a {
                    display: block;
                    line-height: inherit;
                    @include lib-css(background, $-submenu-item-background-color);
                    @include lib-css(border, $-submenu-item-border);
                    @include lib-css(color, $-submenu-item-color);
                    @include lib-css(padding, $-submenu-item-padding);
                    @include lib-css(text-decoration, $-submenu-item-text-decoration);

                    &:hover,
                    &.ui-state-focus {
                        @include lib-css(background, $-submenu-item-hover-background-color);
                        @include lib-css(border, $-submenu-item-border-hover);
                        @include lib-css(color, $-submenu-item-color-hover);
                        @include lib-css(text-decoration, $-submenu-item-text-decoration-hover);
                    }
                }

                .active > a {
                    @include lib-css(background, $-submenu-item-background-color-active);
                    @include lib-css(border-color, $-submenu-item-active-border-color);
                    @include lib-css(border-style, $-submenu-item-active-border-style);
                    @include lib-css(border-width, $-submenu-item-active-border-width);
                    @include lib-css(color, $-submenu-item-color-active);
                    @include lib-css(text-decoration, $-submenu-item-text-decoration-active);
                }

                .submenu {
                    top: 0 !important;
                    left: 100% !important;
                }

                .submenu-reverse {
                    left: auto !important;
                    right: 100%;
                }
            }

            &.more {
                position: relative;
                @include lib-icon-font(
                    $icon-pointer-down,
                    $-icon-font-size     : 26px,
                    $-icon-font-position : after
                );

                &:before {
                    display: none;
                }

                &:after {
                    cursor: pointer;
                    padding: 8px 12px;
                    position: relative;
                    z-index: 1;
                }

                &:hover > .submenu {
                    overflow: visible !important;
                }

                li {
                    display: block;
                }
            }
        }
    }
}

//  Submenu arrow
@mixin _lib-submenu-arrow(
    $-submenu-arrow,
    $-bg,
    $-border,
    $-size,
    $-left
) {
    @if $-submenu-arrow == true {
        @if iscolor($-bg) and iscolor($-border) {
            $-outer-size: $-size + 1;
            $-outer-left: $-left - 1;
            @include lib-css(margin-top, $-outer-size);

            > ul {
                @include lib-css(margin-top, $-outer-size);

                &:before,
                &:after {
                    content: '';
                    display: block;
                    overflow: hidden;
                    position: absolute;
                }

                &:before {
                    @include lib-css(color, $-bg);
                    @include lib-css(left, $-left);
                    @include lib-css(top, -$-size*2);
                    @include lib-arrow(up, $-size, $-bg);
                    z-index: 4;
                }

                &:after {
                    @include lib-arrow(up, $-outer-size, $-border);
                    @include lib-css(color, $-border);
                    @include lib-css(left, $-outer-left);
                    @include lib-css(top, -$-outer-size*2);
                    z-index: 3;
                }
            }
        }

        @if iscolor($-bg) and iscolor($-border) == false {
            @include lib-css(margin-top, -$-size);

            > ul {
                @include lib-css(margin-top, $-size);

                &:before {
                    @include lib-arrow(up, $-size, $-bg);
                    @include lib-css(color, $-bg);
                    @include lib-css(left, $-left);
                    @include lib-css(top, -$-size*2);
                    content: '';
                    display: block;
                    overflow: hidden;
                    position: absolute;
                    z-index: 4;
                }
            }
        }

        @if iscolor($-border) and iscolor($-bg) == false {
            @include lib-css(margin-top, -$-size);

            > ul {
                @include lib-css(margin-top, $-size);

                &:before {
                    @include lib-arrow(up, $-size, $-border);
                    @include lib-css(color, $-border);
                    @include lib-css(left, $-left);
                    @include lib-css(top, -$-size*2);
                    content: '';
                    display: block;
                    overflow: hidden;
                    position: absolute;
                    z-index: 4;
                }
            }
        }
    }
}
