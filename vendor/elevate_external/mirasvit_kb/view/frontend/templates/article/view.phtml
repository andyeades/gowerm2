<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>
<!--
<link rel="stylesheet" type="text/css" href="/js/webforms/opentip/opentip.css"/>
<link rel="stylesheet" type="text/css" href="/skin/frontend/base/default/webforms/form.css" media="all"/>
<link rel="stylesheet" type="text/css" href="/skin/frontend/base/default/webforms/results.css" media="all"/>
<link rel="stylesheet" type="text/css" href="/skin/frontend/base/default/webforms/stars.css" media="all"/>
<link rel="stylesheet" type="text/css" href="/skin/frontend/happybeds/default/bootstrap/dist/elevate-list-and-view-5.css" media="all">

<script type="text/javascript" src="/js/webforms/logic.js"></script>
<script type="text/javascript" src="/js/webforms/dropzone.js"></script>
<script type="text/javascript" src="/js/webforms/opentip/opentip-native-excanvas.min.js"></script>
<script type="text/javascript" src="/js/webforms/multistep.js"></script>
<script type="text/javascript" src="/skin/frontend/happybeds/default/bootstrap/js/slick.min.js"></script>
-->

<!-- Go to www.addthis.com/dashboard to customize your tools -->
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-580f7e82adb58548"></script>

<?php
/** @var \Mirasvit\Kb\Block\Article\View $block */
$article = $block->getArticleByRepo();
$article_id = $article->getArticleId();
$article_categories = $block->getArticle()->getCategories();
$tags = $block->getTags();
$articlesections_obj = $block->getArticleSections($article_id);
$articlesections = $articlesections_obj->getItems();

$article_header_image = $this->getUrl('pub/media').'wysiwyg/kbarticles/header-images/' . $article->getArticleHeaderImage();
$article_title = $article->getName();

$helper = $block->getHelper();
//$currentUrl = $this->helper('core/url')->getCurrentUrl();

?>
<style>
    .sidebarcheck.stickymy {
        -moz-osx-font-smoothing: grayscale;
        -webkit-font-smoothing:  antialiased;
        font-smoothing:          antialiased;
        transform:               translateZ(0);
        -webkit-transform:       translateZ(0);
    }

    a.conQLShLink {
        display:         block;
        margin:          0;
        padding:         2px 0 2px 25px;
        min-height:      12px;
        font-size:       12px;
        line-height:     1.4em;
        color:           #191919;
        text-decoration: none;
    }


    .conQLShDot {
        position:         absolute;
        left:             2px;
        display:          block;
        margin:           -6px 0 0;
        width:            8px;
        height:           8px;
        border-color:     #b2b2b2;
        border-radius:    8px;
        background-color: #fff;
    }

    .conQLShItm.active a .conQLShDot {
        background-color: #f0376c;
        border-color:     #f0376c;
    }

    .conQLSh {
        display:    none;
        margin:     0;
        padding:    5px 0 0;
        list-style: none;
    }


    .ev_question_faq {
        padding: 0px !important;
    }


    .faq-accordion-open-close {
        float: right;
    }


    .about-author {
        -webkit-box-shadow: none;
        box-shadow:         none;
        background:         #fff;
        padding:            0 0 10px 0;
        border:             1px solid #d8d8d8;
        /*    margin-bottom: 30px;*/
        margin-top:         30px;
        border:             none;
    }

    .author-headshot {
        float: left;
    }

    .author-headshot img {
        border-radius: 50%;
        width:         64px;
    }

    .about-author .author {
        margin-top:     15px;
        left:           11px;
        position:       relative;
        border:         none;
        font-style:     normal !important;
        letter-spacing: 0 !important;
        font-size:      16px !important;
        line-height:    20px !important;
        float:          none;
        color:          #757575;
    }


    .testjgstyle {
        bottom: 822px;
        top:    initial !important;
    }

    .stickymy {
        transition: all 0.5s ease 0s;
    }

    .morecontent span {
        display: none;
    }

    .morelink {
        display: inline-block;
    }

    .read-all-link {
        font-size:   13px;
        display:     inline-block;
        float:       right;
        padding-top: 10px;
    }

</style>

<article class="kb-article-view-article">

    <div class="container">
        <div class="row kb-article-row">
            <div class="left-sidebar-sharing col-md-1 hidden-xs">


                <!-- Go to www.addthis.com/dashboard to customize your tools -->
                <div class="addthis_inline_share_toolbox_g09t sidebar-addthis sticky"></div>


            </div>
            <div class="col-xs-12 col-sm-8 kb-article-wrapper">
                <div id="kb-article-view-inner" class="kb-article-view-inner">

                    <h1><?php echo $article->getName() ?></h1>

                    <img src="<?= $article_header_image; ?>" class="img-responsive"/>


                    <!-- Go to www.addthis.com/dashboard to customize your tools -->
                    <div class="addthis_inline_share_toolbox_g09t main-content-addthis"></div>


                    <?= $block->getParsedContent($article->getText()) ?>
                    <div class="kb-article-sections">
                        <?php foreach ($articlesections as $articlesection) {

                            $articlesection_data = $articlesection->getAllData();

                            $url_to_output = $block->getSectionUrl($articlesection_data['asec_name']);

                            $articlesection_id = $articlesection_data['articlesection_id'];
                            $articlesubsections_obj = $block->getArticleSubSections($articlesection_id);
                            $articlesubsections = $articlesubsections_obj->getItems();
                            $asubsec_count = $articlesubsections_obj->getTotalCount();

                            if ($asubsec_count > 0) {
                                $parent_name = $url_to_output;
                            }
                            ?>
                            <div class="kb-article-section-inner">
                                <h2 id="<?= preg_replace('/[^a-zA-Z0-9_ -]/s', '', $url_to_output); ?>"><?php echo $articlesection_data['asec_name']; ?></h2>
                                <?php if (!empty($articlesection_data['asec_value'])) { ?>

                                    <div><?=$block->getParsedContent($articlesection_data['asec_value']);   ?></div>
                                <?php }
                                if ($asubsec_count > 0) { ?>
                                    <div class="kb-article-sub-sections">
                                        <?php foreach ($articlesubsections as $articlesubsection) { ?>

                                            <?php

                                            $articlesection_sub_data = $articlesubsection->getAllData();
                                            $url_to_output = $block->getSectionUrl($articlesection_sub_data['asecsub_name']); ?>

                                            <div class="faq-wrapper kb-article-sub-section-inner">
                                                <div class="ev_content_block ev_question_faq">
                                                    <h3 class="faq-item-header" id="<?= $url_to_output; ?>"><?= $articlesection_sub_data['asecsub_name']; ?>
                                                        <i class="faq-accordion-open-close fa fa-chevron-right"></i></h3>
                                                    <div class="faq-content">
                                                        <?= $block->getParsedContent($articlesection_sub_data['asecsub_value']); ?>
                                                    </div>
                                                </div>
                                            </div>

                                        <?php } ?>
                                    </div>
                                <?php } ?>
                            </div>
                        <?php } ?>
                    </div>
                    <?php
                    $disable_cat_and_share = 1;
                    if ($disable_cat_and_share != 1) { ?>
                        <div class="row">
                            <div class="col-xs-12 col-sm-6">
                                <div class="kb-categories">
                                    <?php $disable_category = 1; ?>
                                    <?php if ($disable_category != 1) { ?><?php echo 'Categories:' ?><?php foreach ($categories as $category) { ?>
                                        <a class="label happybeds-label" href="<?php echo $category->getUrl() ?>"><?php echo $category->getName() ?></a>
                                    <?php } ?><?php } ?>
                                </div>
                            </div>
                            <div class="col-xs-12 col-sm-6">
                                <div class="share-this-block">
                                    <div class="share-this-block-inner">
                                        <?php //$companyname = Mage::app()->getWebsite()->getName(); ?>
                                        <?php $companyname = ''; ?>
                                        <?php $emailsubjecttext = "Check Out the " . $article_title . " on the " . $companyname . " Website"; ?>
                                        <?php $emailmailto = rawurlencode($emailsubjecttext); ?>
                                        <?php //$emailbody = rawurlencode($currentUrl); ?>
                                        <?php $emailbody = ''; ?>

                                        <?php $linktext = $article_title; ?>
                                        <?php $the_link = urlencode($linktext); ?>
                                        <?php $the_title = urlencode($article_title); ?>
                                        <?php //$the_url = urlencode($currentUrl); ?>
                                        <?php $the_url = ''; ?>
                                        <?php $the_image_url = urlencode($article_header_image); ?>
                                        <?php

                                        $email_a_friend_on = 0;
                                        $pinterest_on = 0;

                                        ?>

                                        <div class="share-this-left">
                                            <i class="share-this-ico fa fa-3x fa-share-alt"></i>
                                            <div class="share-this-title">Share This</div>
                                        </div>
                                        <div class="share-icons">
                                            <?php if ($email_a_friend_on == 1) { ?>

                                                <a class="share-ico-mail" href="<?php //echo $this->helper('catalog/product')->getEmailToFriendUrl($_product) ?>"><i class="fa fa-envelope"></i></a>
                                            <?php } else { ?>
                                                <a target="_blank" href="mailto:?subject=<?php echo $emailmailto; ?>&body=<?php echo $emailbody; ?>" class="share-ico-mail"><i class="fa fa-envelope"></i></a>
                                            <?php } ?>
                                            <a target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=<?php echo $the_url; ?>" class="soc-ico-fb share-ico-facebook"><i class="fa fa-facebook-f"></i></a>
                                            <?php if ($pinterest_on == 1) { ?>
                                                <a target="_blank" href="http://pinterest.com/pin/create/button/?url=<?php echo $the_url; ?>&media=<?php echo $the_image_url; ?>&description=<?php echo $the_title; ?> " class="pin-it-button" count-layout="horizontal"><i class="fa fa-pinterest"></i></a>
                                            <?php } ?>
                                            <a target="_blank" href="https://twitter.com/intent/tweet?text=<?php echo $the_link ?>&url=<?php echo $the_url ?>" class="soc-ico-twit share-ico-twitter"><i class="fa fa-twitter"></i></a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    <?php } ?>


                    <?php
                    $rating_show = 0;

                    if ($rating_show != 0) {


                        if ($block->isRatingEnabled()) { ?>
                            <div class="kb-helpful bg-info">
                                <div class="kb-helpful-header-title">Was this article helpful?</div>
                                <?php if (!$block->getVoteResult()) { ?>
                                    <a class="kb-helpful-yes btn btn-success" href="<?php echo $block->getVoteUrl(5) ?>"><?php echo 'Helpful'?></a>
                                    <a class="kb-helpful-no btn btn-danger" href="<?php echo $block->getVoteUrl(1) ?>"><?php echo 'Not helpful' ?></a>
                                <?php } else {
                                    if ($block->getVoteResult() == 5) {

                                        if ($article->getPostiveVoteNum() > 1) {
                                            echo __('You and %s people found this helpful.', $article->getPostiveVoteNum());
                                        } else {
                                            echo __('You found this helpful.');
                                        }
                                    }
                                }
                                ?>
                            </div>
                            <?php
                        }
                    }
                    ?>

                </div>


            </div>
            <div id="kb-article-sidebar-outer" class="opened-up col-xs-12 col-sm-3">

                <div class="stickymy">
                    <div class="kb-article-sidebar ">


                        <div class="kb-article-tg">
                            <div id="kb-article-tg-title" class="kb-article-tg-title">
                                In this guide
                                <div class="open-close-sidebaritem"><i class="fa fa-chevron-down"></i></div>
                            </div>
                            <div id="kb-article-tg-list-outer">

                                <ul class="kb-article-tg-list-pri nav">
                                    <?php

                                    $asec_count = $articlesections_obj->getTotalCount();
                                    $i = 1;
                                    $len = $asec_count;

                                    ?>
                                    <?php foreach ($articlesections as $articlesection) {


                                        $articlesection_data = $articlesection->getAllData();
                                        $url_to_output = $block->getSectionUrl($articlesection_data['asec_name']);

                                        $articlesection_id = $articlesection_data['articlesection_id'];
                                        $articlesubsections_obj = $block->getArticleSubSections($articlesection_id);
                                        $articlesubsections = $articlesubsections_obj->getItems();
                                        $asubsec_count = $articlesubsections_obj->getTotalCount();

                                        if ($asubsec_count > 0) {
                                            $parent_name = $url_to_output;
                                        }

                                        $class_output = '';

                                        if ($i == 1) {
                                            $class_output .= ' conQLHItmFirst';
                                        }
                                        if ($i == $len) {
                                            $class_output .= ' conQLHItmLast';
                                        }
                                        if ($asubsec_count > 0) {
                                            $class_output .= ' kb-article-tg-list-outer-with-inners';
                                        }
                                        $additional_output = '';
                                        if ($asubsec_count > 0) {
                                            $additional_output .= 'data-parent-name="' . $parent_name . '"';
                                        } ?>


                                        <li class="nav-item kb-article-tg-list-outer <?= $class_output; ?>" <?= $additional_output; ?>>
                                            <a href="#<?php echo preg_replace('/[^a-zA-Z0-9_ -]/s', '', $url_to_output); ?>" class="nav-link kb-article-tg-list-openclose smooth-goto">
                                                <span class="conQLHLine"></span> <span class="conQLHDot"></span>
                                                <?= $articlesection_data['asec_name']; ?>
                                            </a>
                                            <?php if ($asubsec_count > 0) { ?>
                                                <ul class="nav conQLSh">
                                                    <?php
                                                    $articlesubsectioncount = 0;
                                                    $art = 1;
                                                    $art_len = $asubsec_count;
                                                    foreach ($articlesubsections as $articlesubsection) {

                                                        $url_to_output = $block->getSectionUrl($articlesection_data['asec_name']);
                                                        $sub_class_output = '';

                                                        if ($art == 1) {
                                                            $sub_class_output .= ' conQLShItmFirst';
                                                        }
                                                        if ($art == $asubsec_count) {
                                                            $sub_class_output .= ' conQLShItmLast';
                                                        }

                                                        $articlesection_sub_data = $articlesubsection->getAllData();
                                                        $url_to_output = $block->getSectionUrl($articlesection_sub_data['asecsub_name']); ?>
                                                        <li class="nav-item conQLShItm <?= $sub_class_output; ?>" data-section-parent="<?php echo $parent_name; ?>">
                                                            <a class="conQLShLink" href="#<?php echo preg_replace('/[^a-zA-Z0-9_ -]/s', '', $url_to_output); ?>">
                                                                <span class="conQLHLine"></span><span class="conQLShDot"></span>
                                                                <?= $articlesection_sub_data['asecsub_name']; ?>
                                                            </a>

                                                        </li>

                                                        <?php   $art++;
                                                    } ?>
                                                </ul>
                                            <?php } ?>

                                            <span class="conQLLine"></span>
                                        </li>


                                        <?php $i++ ?>

                                    <?php } ?>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <div id="guide-search-wrap">

                        <div class="block-title">Search Guides</div>
                        <form action="<?= $block->getUrl('kbase/article/s')?>" method="GET" id="kb-s-form">
                            <input name='s' id='s' placeholder="<?php echo __('Search Guides') ?>" class="form-control input-text required-entry" value="<?php echo $this->getQuery() ?>">
                            <button type="submit" title="Submit" class="btn button action secondary btn-hbgreen">Search</button>
                        </form>
                    </div>


                </div>
            </div>
        </div>

    </div>
    <div id="additonal-content-bottom"></div>

</article>


<script>
    jQuery(document).ready(function () {
        /* ========================================================================
         * Bootstrap: scrollspy.js v3.3.6
         * http://getbootstrap.com/javascript/#scrollspy
         * ========================================================================
         * Copyright 2011-2015 Twitter, Inc.
         * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
         * ======================================================================== */


        +function ($) {
            'use strict';

            // SCROLLSPY CLASS DEFINITION
            // ==========================

            function ScrollSpy(element, options) {
                this.$body          = $(document.body)
                this.$scrollElement = $(element).is(document.body) ? $(window) : $(element)
                this.options        = $.extend({}, ScrollSpy.DEFAULTS, options)
                this.selector       = (this.options.target || '') + ' .nav li > a'
                this.offsets        = []
                this.targets        = []
                this.activeTarget   = null
                this.scrollHeight   = 0

                this.$scrollElement.on('scroll.bs.scrollspy', $.proxy(this.process, this))
                this.refresh()
                this.process()
            }

            ScrollSpy.VERSION  = '3.3.6'

            ScrollSpy.DEFAULTS = {
                offset: 10
            }

            ScrollSpy.prototype.getScrollHeight = function () {
                return this.$scrollElement[0].scrollHeight || Math.max(this.$body[0].scrollHeight, document.documentElement.scrollHeight)
            }

            ScrollSpy.prototype.refresh = function () {
                var that          = this
                var offsetMethod  = 'offset'
                var offsetBase    = 0

                this.offsets      = []
                this.targets      = []
                this.scrollHeight = this.getScrollHeight()

                if (!$.isWindow(this.$scrollElement[0])) {
                    offsetMethod = 'position'
                    offsetBase   = this.$scrollElement.scrollTop()
                }

                this.$body
                    .find(this.selector)
                    .map(function () {
                        var $el   = $(this)
                        var href  = $el.data('target') || $el.attr('href')
                        var $href = /^#./.test(href) && $(href)

                        return ($href
                            && $href.length
                            && $href.is(':visible')
                            && [[$href[offsetMethod]().top + offsetBase, href]]) || null
                    })
                    .sort(function (a, b) { return a[0] - b[0] })
                    .each(function () {
                        that.offsets.push(this[0])
                        that.targets.push(this[1])
                    })
            }

            ScrollSpy.prototype.process = function () {
                var scrollTop    = this.$scrollElement.scrollTop() + this.options.offset
                var scrollHeight = this.getScrollHeight()
                var maxScroll    = this.options.offset + scrollHeight - this.$scrollElement.height()
                var offsets      = this.offsets
                var targets      = this.targets
                var activeTarget = this.activeTarget
                var i

                if (this.scrollHeight != scrollHeight) {
                    this.refresh()
                }

                if (scrollTop >= maxScroll) {
                    return activeTarget != (i = targets[targets.length - 1]) && this.activate(i)
                }

                if (activeTarget && scrollTop < offsets[0]) {
                    this.activeTarget = null
                    return this.clear()
                }

                for (i = offsets.length; i--;) {
                    activeTarget != targets[i]
                    && scrollTop >= offsets[i]
                    && (offsets[i + 1] === undefined || scrollTop < offsets[i + 1])
                    && this.activate(targets[i])
                }
            }

            ScrollSpy.prototype.activate = function (target) {
                this.activeTarget = target

                this.clear()

                var selector = this.selector +
                    '[data-target="' + target + '"],' +
                    this.selector + '[href="' + target + '"]'

                var active = $(selector)
                    .parents('li')
                    .addClass('active')

                if (active.parent('.dropdown-menu').length) {
                    active = active
                        .closest('li.dropdown')
                        .addClass('active')
                }

                active.trigger('activate.bs.scrollspy')
            }

            ScrollSpy.prototype.clear = function () {
                $(this.selector)
                    .parentsUntil(this.options.target, '.active')
                    .removeClass('active')
            }


            // SCROLLSPY PLUGIN DEFINITION
            // ===========================

            function Plugin(option) {
                return this.each(function () {
                    var $this   = $(this)
                    var data    = $this.data('bs.scrollspy')
                    var options = typeof option == 'object' && option

                    if (!data) $this.data('bs.scrollspy', (data = new ScrollSpy(this, options)))
                    if (typeof option == 'string') data[option]()
                })
            }

            var old = $.fn.scrollspy

            $.fn.scrollspy             = Plugin
            $.fn.scrollspy.Constructor = ScrollSpy


            // SCROLLSPY NO CONFLICT
            // =====================

            $.fn.scrollspy.noConflict = function () {
                $.fn.scrollspy = old
                return this
            }


            // SCROLLSPY DATA-API
            // ==================

            $(window).on('load.bs.scrollspy.data-api', function () {
                $('[data-spy="scroll"]').each(function () {
                    var $spy = $(this)
                    Plugin.call($spy, $spy.data())
                })
            })

        }(jQuery);


        jQuery(".kb-article-tg-list-outer").click(function () {

            if (jQuery(this).closest("li").children("ul").length) {

                console.log("Has UL");

                jQuery(this).children("ul").show().slideDown();

            } else {
                jQuery(".kb-article-tg-list-outer").removeClass("active");
                jQuery(this).addClass("active");
                jQuery(".conQLSh").hide().slideUp();
            }
        });


        jQuery('.faq-item-header').click(function () {
            console.log("clicked");
            jQuery(this).next('.faq-content').slideToggle();
            if (jQuery(this).children('.faq-accordion-open-close').hasClass("fa-chevron-right")) {
                jQuery(this).children('.faq-accordion-open-close').removeClass('fa-chevron-right').addClass('fa-chevron-down');
            } else {
                jQuery(this).children('.faq-accordion-open-close').removeClass('fa-chevron-down').addClass('fa-chevron-right');
            }
        });


        //adds in the data attribute
        jQuery("body").scrollspy({
            target: ".kb-article-sidebar",
            offset: 20
        });

        jQuery('.kb-article-sidebar').on('activate.bs.scrollspy', function () {
            var activeitem = jQuery('.kb-article-tg-list-pri li.active');
            //console.log(activeitem);
            if (jQuery(activeitem).hasClass('kb-article-tg-list-outer')) {

                var data_parent_name = jQuery(activeitem).attr('data-parent-name');
                var itemstohide = jQuery('.kb-article-tg-list-inner[data-section-parent]');
                var itemstoshow = jQuery('.kb-article-tg-list-inner[data-section-parent="' + data_parent_name + '"]');
                jQuery.each(itemstohide, function (index, value) {
                    jQuery(value).hide();
                });
                jQuery.each(itemstoshow, function (index, value) {
                    jQuery(value).show();
                });
            }

            if (jQuery(activeitem).hasClass('kb-article-tg-list-inner')) {
                var data_section_parent = jQuery(activeitem).attr('data-section-parent');
                jQuery(activeitem).parent().find('[data-section-parent="' + data_section_parent + '"]').show();

            }


        });

        var MqL = 768;
        var scrollTimer, wasTooBig = 0, lastScrollFireTime = 0;

        jQuery(window).on('scroll', function () {

            var minScrollTime = 50;
            var now = new Date().getTime();
            var sidebar_element_height = jQuery('.kb-article-sidebar').outerHeight();
            var footer_height = jQuery('#elevate-footer').outerHeight();
            var newsletter_wrapper_height = jQuery('#home-newsletter').outerHeight();
            var page_bottom_height = footer_height + newsletter_wrapper_height + 17;


            jQuery('.kb-article-sidebar').on('activate.bs.scrollspy', function () {
                var activeitem = jQuery('.kb-article-tg-list-pri li.active');
                //console.log(activeitem);
                if (jQuery(activeitem).hasClass('kb-article-tg-list-outer')) {

                    var data_parent_name = jQuery(activeitem).attr('data-parent-name');
                    var itemstohide = jQuery('.kb-article-tg-list-inner[data-section-parent]');
                    var itemstoshow = jQuery('.kb-article-tg-list-inner[data-section-parent="' + data_parent_name + '"]');
                    jQuery.each(itemstohide, function (index, value) {
                        jQuery(value).hide();
                    });
                    jQuery.each(itemstoshow, function (index, value) {
                        jQuery(value).show();
                    });
                }

                if (jQuery(activeitem).hasClass('kb-article-tg-list-inner')) {
                    var data_section_parent = jQuery(activeitem).attr('data-section-parent');
                    jQuery(activeitem).parent().find('[data-section-parent="' + data_section_parent + '"]').show();

                }


            });

            jQuery('.kb-article-sidebar .conQLSh').on('activate.bs.scrollspy', function () {

            });


            function ev_recalcaffixwidth() {
                var windowcheck = ev_checkWindowWidth();
                var size_element = jQuery('#kb-article-sidebar-outer').width();
                console.log("Recalc Affix Width");
                console.log(size_element);
                if (windowcheck === true) {
                    jQuery('.kb-article-sidebar').css('width', size_element + 'px');
                } else {
                    jQuery('.kb-article-sidebar').css('width', '');
                    jQuery('.kb-article-sidebar').css('width', '100%;');
                }
            }

            function ev_checkWindowWidth() {
                //check window width (scrollbar included)
                var e = window,
                    a = 'inner';
                if (!('innerWidth' in window)) {
                    a = 'client';
                    e = document.documentElement || document.body;
                }

                var width = e[a + 'Width'];

                if (width >= MqL) {
                    return true;
                } else {

                    return false;
                }
            }

            function ev_moveNavigation() {
                var desktop = ev_checkWindowWidth();
                var guidesearchbox = jQuery('#guide-search-wrap');
                var guidesaddtionalcontent = jQuery('#categories-wrap');

                if (desktop === true) {
                    ev_openuparticlesidebar();
                    guidesearchbox.detach().appendTo('.kb-article-sidebar');
                    guidesaddtionalcontent.detach().appendTo('.kb-article-sidebar');

                }

                if (desktop === false) {

                    jQuery('.smooth-goto').on('click', function () {
                        jQuery('html, body').animate({scrollTop: jQuery(this.hash).offset().top - 70}, 1000);
                        ev_closeuparticlesidebar();
                        return false;
                    });

                    jQuery('#kb-article-tg-list-outer').hide();
                    ev_closeuparticlesidebar();

                    jQuery('.kb-article-tg-list-outer').click(function () {
                        var selected = jQuery(this);
                        ev_closeuparticlesidebar();
                    });

                    guidesearchbox.detach().appendTo('#additonal-content-bottom');
                    guidesaddtionalcontent.detach().appendTo('#additonal-content-bottom');

                    // Configure/customize these variables.
                    var showChar = 50;  // How many characters are shown by default
                    var ellipsestext = "...";
                    var moretext = "Show more >";
                    var lesstext = "Show less";


                    jQuery('.more').each(function () {
                        var content = jQuery(this).html();

                        if (content.length > showChar) {

                            var c = content.substr(0, showChar);
                            var h = content.substr(showChar, content.length - showChar);

                            var html = c + '<span class="moreellipses">' + ellipsestext + '&nbsp;</span><span class="morecontent"><span>' + h + '</span>&nbsp;&nbsp;<a href="" class="morelink">' + moretext + '</a></span>';

                            jQuery(this).html(html);
                        }

                    });

                    jQuery(".morelink").click(function () {
                        if (jQuery(this).hasClass("less")) {
                            jQuery(this).removeClass("less");
                            jQuery(this).html(moretext);
                        } else {
                            jQuery(this).addClass("less");
                            jQuery(this).html(lesstext);
                        }
                        jQuery(this).parent().prev().toggle();
                        jQuery(this).prev().toggle();
                        return false;
                    });


                }
            }

            function ev_openuparticlesidebar() {
                jQuery('#kb-article-tg-list-outer').slideDown();
                jQuery('#kb-article-tg-title .open-close-sidebaritem i').removeClass('fa-chevron-right').addClass('fa-chevron-down');
                jQuery('#kb-article-sidebar-outer').addClass('opened-up').removeClass('closed-up');
//      jQuery('body').css("overflow", "hidden");
            }

            function ev_closeuparticlesidebar() {
                jQuery('#kb-article-tg-list-outer').slideUp();
                jQuery('#kb-article-tg-title .open-close-sidebaritem i').removeClass('fa-chevron-down').addClass('fa-chevron-right');
                jQuery('#kb-article-sidebar-outer').removeClass('opened-up').addClass('closed-up');
            }

            jQuery('.kb-article-tg-title').click(function () {
                var selected = jQuery(this);
                if (jQuery('#kb-article-tg-list-outer').is(':visible')) {
                    ev_closeuparticlesidebar();
                } else {
                    ev_openuparticlesidebar();
                }


            });

            ev_moveNavigation();
        });
    });

</script>
